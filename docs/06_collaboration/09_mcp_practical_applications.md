# ãƒ¬ã‚·ãƒ”#6-9: å®Ÿè·µçš„ãªMCPæ´»ç”¨ã§BYOAã‚¢ãƒ—ãƒªã‚’é€²åŒ–ã•ã›ã‚‹

08ç« ã§MCPã®åŸºç¤ã‚’å­¦ã³ã¾ã—ãŸã€‚ã“ã®ç« ã§ã¯ã€07ç« ã§ä½œã£ãŸ**ç‰¹åŒ–å‹æ©Ÿèƒ½**ã«**MCP**ã‚’çµ±åˆã—ã¦ã€ã•ã‚‰ã«å¼·åŠ›ãªBYOAã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚

å®Ÿéš›ã®ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’é€šã˜ã¦ã€MCPãŒã©ã®ã‚ˆã†ã«ç‹¬è‡ªã®ä¾¡å€¤ã‚’ç”Ÿã¿å‡ºã™ã‹ã‚’è¦‹ã¦ã„ãã¾ã—ã‚‡ã†ã€‚

---

## MCPãŒç‰¹åŒ–å‹æ©Ÿèƒ½ã«ã‚‚ãŸã‚‰ã™ä¾¡å€¤

### 07ç« ã®ç‰¹åŒ–å‹æ©Ÿèƒ½ã®é™ç•Œ

```
ã€è‚²å…ã‚¢ãƒ—ãƒªã€‘
âœ… è¨˜éŒ²ã‹ã‚‰ã‚¢ãƒ«ãƒãƒ ç”Ÿæˆï¼ˆ07ç« ã§å®Ÿè£…ï¼‰
âŒ ã§ã‚‚ã€åœ°åŸŸã®ä¿è‚²åœ’æƒ…å ±ã¯æ‰‹å‹•ã§æ¢ã™
âŒ äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã¯åˆ¥ç®¡ç†

ã€æ ½åŸ¹ã‚¢ãƒ—ãƒªã€‘
âœ… æ ½åŸ¹è¨˜éŒ²ã‹ã‚‰è²©å£²ãƒšãƒ¼ã‚¸ç”Ÿæˆï¼ˆ07ç« ã§å®Ÿè£…ï¼‰
âŒ ã§ã‚‚ã€å¤©æ°—ã¯è‡ªåˆ†ã§ç¢ºèª
âŒ å¸‚å ´ä¾¡æ ¼ã¯åˆ¥é€”ãƒªã‚µãƒ¼ãƒ

ã€å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒªã€‘
âœ… æŠ•è³‡åˆ†ææ©Ÿèƒ½ï¼ˆ07ç« ã§å®Ÿè£…ï¼‰
âŒ ã§ã‚‚ã€æ ªä¾¡ã¯æ‰‹å‹•ã§å…¥åŠ›
âŒ ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã‚‚æ‰‹å‹•æ›´æ–°
```

### MCPã«ã‚ˆã‚‹æ‹¡å¼µ

```
ã€è‚²å…ã‚¢ãƒ—ãƒª + MCPã€‘
âœ… åœ°åŸŸä¿è‚²åœ’æƒ…å ±ã‚’è‡ªå‹•å–å¾—ï¼ˆNursery MCPï¼‰
âœ… äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’çµ±åˆï¼ˆHealth MCPï¼‰
âœ… æˆé•·ãƒ‡ãƒ¼ã‚¿ã‚’åŒ»ç™‚åŸºæº–ã¨æ¯”è¼ƒ

ã€æ ½åŸ¹ã‚¢ãƒ—ãƒª + MCPã€‘
âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ°—è±¡ãƒ‡ãƒ¼ã‚¿ï¼ˆWeather MCPï¼‰
âœ… å¸‚å ´ä¾¡æ ¼æƒ…å ±ï¼ˆMarket MCPï¼‰
âœ… æœ€é©ãªå‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ææ¡ˆ

ã€å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒª + MCPã€‘
âœ… æ ªä¾¡ãƒ»ç‚ºæ›¿ã®è‡ªå‹•æ›´æ–°ï¼ˆFinance MCPï¼‰
âœ… ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¨æŠ•è³‡åˆ¤æ–­ã®çµ±åˆï¼ˆNews MCPï¼‰
âœ… ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®æœ€é©åŒ–ææ¡ˆ
```

---

## ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹1: è‚²å…ã‚¢ãƒ—ãƒª Ã— MCP

### å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

```
ã€åŸºæœ¬æ©Ÿèƒ½ã€‘ï¼ˆ06-07ç« ã§å®Ÿè£…æ¸ˆã¿ï¼‰
- æ—¥ã€…ã®æˆé•·è¨˜éŒ²
- ã‚¢ãƒ«ãƒãƒ è‡ªå‹•ç”Ÿæˆ

ã€MCPçµ±åˆã§è¿½åŠ ã€‘
âœ… åœ°åŸŸã®ä¿è‚²åœ’æƒ…å ±æ¤œç´¢
âœ… äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ç®¡ç†
âœ… æˆé•·æ›²ç·šã¨ã®æ¯”è¼ƒ
âœ… åœ°åŸŸã‚¤ãƒ™ãƒ³ãƒˆæƒ…å ±
```

---

### ã‚«ã‚¹ã‚¿ãƒ MCP: ä¿è‚²åœ’æƒ…å ±ã‚µãƒ¼ãƒãƒ¼

**nursery-mcp-server.ts**

```typescript
import { Server } from '@modelcontextprotocol/sdk/server/index.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';
import {
  CallToolRequestSchema,
  ListToolsRequestSchema,
} from '@modelcontextprotocol/sdk/types.js';

// ä¿è‚²åœ’ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©
interface Nursery {
  id: string;
  name: string;
  address: string;
  latitude: number;
  longitude: number;
  capacity: number;
  ageRange: string;
  phone: string;
  website?: string;
  openingHours: string;
  features: string[];
}

// ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯DBã‚„APIã‹ã‚‰å–å¾—ï¼‰
const nurseries: Nursery[] = [
  {
    id: '1',
    name: 'ã•ãã‚‰ä¿è‚²åœ’',
    address: 'æ±äº¬éƒ½æ¸‹è°·åŒºâ—‹â—‹1-2-3',
    latitude: 35.6586,
    longitude: 139.7454,
    capacity: 60,
    ageRange: '0-5æ­³',
    phone: '03-1234-5678',
    openingHours: '7:30-18:30',
    features: ['åœ’åº­ã‚ã‚Š', 'çµ¦é£Ÿã‚ã‚Š', 'å»¶é•·ä¿è‚²'],
  },
  {
    id: '2',
    name: 'ã²ã¾ã‚ã‚Šä¿è‚²åœ’',
    address: 'æ±äº¬éƒ½æ¸‹è°·åŒºâ–³â–³2-3-4',
    latitude: 35.6612,
    longitude: 139.7435,
    capacity: 40,
    ageRange: '1-5æ­³',
    phone: '03-2345-6789',
    openingHours: '8:00-18:00',
    features: ['å°‘äººæ•°åˆ¶', 'è‹±èªæ•™è‚²', 'é£Ÿè‚²'],
  },
];

// 2ç‚¹é–“ã®è·é›¢è¨ˆç®—ï¼ˆHaversineå…¬å¼ï¼‰
function calculateDistance(
  lat1: number,
  lon1: number,
  lat2: number,
  lon2: number
): number {
  const R = 6371; // åœ°çƒã®åŠå¾„ï¼ˆkmï¼‰
  const dLat = ((lat2 - lat1) * Math.PI) / 180;
  const dLon = ((lon2 - lon1) * Math.PI) / 180;
  const a =
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos((lat1 * Math.PI) / 180) *
      Math.cos((lat2 * Math.PI) / 180) *
      Math.sin(dLon / 2) *
      Math.sin(dLon / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}

const server = new Server(
  {
    name: 'nursery-info',
    version: '1.0.0',
  },
  {
    capabilities: {
      tools: {},
    },
  }
);

server.setRequestHandler(ListToolsRequestSchema, async () => {
  return {
    tools: [
      {
        name: 'search_nurseries',
        description: 'ç¾åœ¨åœ°ã‹ã‚‰æŒ‡å®šè·é›¢å†…ã®ä¿è‚²åœ’ã‚’æ¤œç´¢ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            latitude: {
              type: 'number',
              description: 'ç·¯åº¦',
            },
            longitude: {
              type: 'number',
              description: 'çµŒåº¦',
            },
            radius: {
              type: 'number',
              description: 'æ¤œç´¢åŠå¾„ï¼ˆkmï¼‰',
              default: 3,
            },
            ageRange: {
              type: 'string',
              description: 'å¯¾è±¡å¹´é½¢ï¼ˆä¾‹: 0æ­³, 1-2æ­³ï¼‰',
            },
          },
          required: ['latitude', 'longitude'],
        },
      },
      {
        name: 'get_nursery_details',
        description: 'ä¿è‚²åœ’ã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            nurseryId: {
              type: 'string',
              description: 'ä¿è‚²åœ’ID',
            },
          },
          required: ['nurseryId'],
        },
      },
      {
        name: 'get_vaccination_schedule',
        description: 'äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’å–å¾—ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            birthDate: {
              type: 'string',
              description: 'ç”Ÿå¹´æœˆæ—¥ï¼ˆYYYY-MM-DDï¼‰',
            },
            completedVaccinations: {
              type: 'array',
              items: { type: 'string' },
              description: 'æ¥ç¨®æ¸ˆã¿ã®ãƒ¯ã‚¯ãƒãƒ³',
            },
          },
          required: ['birthDate'],
        },
      },
    ],
  };
});

server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name, arguments: args } = request.params;

  switch (name) {
    case 'search_nurseries': {
      const lat = args.latitude as number;
      const lon = args.longitude as number;
      const radius = (args.radius as number) || 3;

      const nearbyNurseries = nurseries
        .map((n) => ({
          ...n,
          distance: calculateDistance(lat, lon, n.latitude, n.longitude),
        }))
        .filter((n) => n.distance <= radius)
        .sort((a, b) => a.distance - b.distance);

      const result = nearbyNurseries
        .map(
          (n) => `
ğŸ“ ${n.name}
   ä½æ‰€: ${n.address}
   è·é›¢: ${n.distance.toFixed(2)}km
   å®šå“¡: ${n.capacity}å
   å¯¾è±¡: ${n.ageRange}
   ç‰¹å¾´: ${n.features.join(', ')}
   é›»è©±: ${n.phone}
          `
        )
        .join('\n---\n');

      return {
        content: [
          {
            type: 'text',
            text: result || 'æŒ‡å®šç¯„å›²å†…ã«ä¿è‚²åœ’ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ',
          },
        ],
      };
    }

    case 'get_nursery_details': {
      const nurseryId = args.nurseryId as string;
      const nursery = nurseries.find((n) => n.id === nurseryId);

      if (!nursery) {
        throw new Error(`ä¿è‚²åœ’ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${nurseryId}`);
      }

      const details = `
# ${nursery.name}

## åŸºæœ¬æƒ…å ±
- ä½æ‰€: ${nursery.address}
- é›»è©±: ${nursery.phone}
- é–‹åœ’æ™‚é–“: ${nursery.openingHours}
${nursery.website ? `- Website: ${nursery.website}` : ''}

## å®šå“¡ãƒ»å¯¾è±¡å¹´é½¢
- å®šå“¡: ${nursery.capacity}å
- å¯¾è±¡: ${nursery.ageRange}

## ç‰¹å¾´
${nursery.features.map((f) => `- ${f}`).join('\n')}
      `.trim();

      return {
        content: [{ type: 'text', text: details }],
      };
    }

    case 'get_vaccination_schedule': {
      const birthDate = new Date(args.birthDate as string);
      const completed = (args.completedVaccinations as string[]) || [];

      // äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼ˆæ—¥æœ¬ã®æ¨™æº–çš„ãªã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
      const schedule = [
        {
          name: 'ãƒ’ãƒ–ãƒ¯ã‚¯ãƒãƒ³',
          timing: 'ç”Ÿå¾Œ2ãƒ¶æœˆã€œ',
          doses: 4,
          interval: '4-8é€±é–“éš”ã§3å›ã€è¿½åŠ 1å›',
        },
        {
          name: 'å°å…ç”¨è‚ºç‚çƒèŒ',
          timing: 'ç”Ÿå¾Œ2ãƒ¶æœˆã€œ',
          doses: 4,
          interval: '4é€±é–“éš”ã§3å›ã€è¿½åŠ 1å›',
        },
        {
          name: 'Bå‹è‚ç‚',
          timing: 'ç”Ÿå¾Œ2ãƒ¶æœˆã€œ',
          doses: 3,
          interval: '4é€±é–“éš”ã§2å›ã€è¿½åŠ 1å›',
        },
        {
          name: 'ãƒ­ã‚¿ã‚¦ã‚¤ãƒ«ã‚¹',
          timing: 'ç”Ÿå¾Œ2ãƒ¶æœˆã€œ',
          doses: 2,
          interval: '4é€±é–“éš”',
        },
        {
          name: 'å››ç¨®æ··åˆï¼ˆDPT-IPVï¼‰',
          timing: 'ç”Ÿå¾Œ2ãƒ¶æœˆã€œ',
          doses: 4,
          interval: '3-8é€±é–“éš”ã§3å›ã€è¿½åŠ 1å›',
        },
        {
          name: 'BCG',
          timing: 'ç”Ÿå¾Œ5ãƒ¶æœˆã€œ8ãƒ¶æœˆæœªæº€',
          doses: 1,
          interval: '1å›',
        },
        {
          name: 'MRï¼ˆéº»ã—ã‚“é¢¨ã—ã‚“æ··åˆï¼‰',
          timing: '1æ­³ã€œ',
          doses: 2,
          interval: '1æœŸã€2æœŸï¼ˆå¹´é•·ï¼‰',
        },
        {
          name: 'æ°´ç—˜ï¼ˆæ°´ã¼ã†ãã†ï¼‰',
          timing: '1æ­³ã€œ',
          doses: 2,
          interval: '3ãƒ¶æœˆä»¥ä¸Šã‚ã‘ã¦2å›',
        },
      ];

      const now = new Date();
      const ageInMonths =
        (now.getTime() - birthDate.getTime()) / (1000 * 60 * 60 * 24 * 30);

      const upcoming = schedule
        .filter((v) => !completed.includes(v.name))
        .map((v) => {
          let status = 'ä»Šå¾Œæ¥ç¨®';
          if (v.timing.includes('2ãƒ¶æœˆ') && ageInMonths >= 2) {
            status = 'æ¥ç¨®å¯èƒ½';
          } else if (v.timing.includes('5ãƒ¶æœˆ') && ageInMonths >= 5) {
            status = 'æ¥ç¨®å¯èƒ½';
          } else if (v.timing.includes('1æ­³') && ageInMonths >= 12) {
            status = 'æ¥ç¨®å¯èƒ½';
          }

          return `
${v.name}
  æ¥ç¨®æ™‚æœŸ: ${v.timing}
  å›æ•°: ${v.doses}å›ï¼ˆ${v.interval}ï¼‰
  çŠ¶æ…‹: ${status}
          `.trim();
        })
        .join('\n\n');

      const result = `
# äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

ç¾åœ¨ã®æœˆé½¢: ${Math.floor(ageInMonths)}ãƒ¶æœˆ

## æ¥ç¨®æ¸ˆã¿
${completed.length > 0 ? completed.map((v) => `- ${v}`).join('\n') : 'ãªã—'}

## ä»Šå¾Œã®äºˆå®š
${upcoming}
      `.trim();

      return {
        content: [{ type: 'text', text: result }],
      };
    }

    default:
      throw new Error(`Unknown tool: ${name}`);
  }
});

async function main() {
  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.error('Nursery Info MCP Server running');
}

main().catch(console.error);
```

---

### è‚²å…ã‚¢ãƒ—ãƒªã§ã®MCPæ´»ç”¨

**Claude Projectsã§ã®ä½¿ç”¨ä¾‹**

```
ã€ã‚ãªãŸã€‘
ç¾åœ¨åœ°ï¼ˆç·¯åº¦35.6586ã€çµŒåº¦139.7454ï¼‰ã‹ã‚‰
2kmä»¥å†…ã®ä¿è‚²åœ’ã‚’æ¢ã—ã¦

ã€Claudeã€‘
Nursery Info MCPã‚’ä½¿ã£ã¦æ¤œç´¢ã—ã¾ã™...

ğŸ“ ã•ãã‚‰ä¿è‚²åœ’
   ä½æ‰€: æ±äº¬éƒ½æ¸‹è°·åŒºâ—‹â—‹1-2-3
   è·é›¢: 0.00km
   å®šå“¡: 60å
   å¯¾è±¡: 0-5æ­³
   ç‰¹å¾´: åœ’åº­ã‚ã‚Š, çµ¦é£Ÿã‚ã‚Š, å»¶é•·ä¿è‚²
   é›»è©±: 03-1234-5678

---

ğŸ“ ã²ã¾ã‚ã‚Šä¿è‚²åœ’
   ä½æ‰€: æ±äº¬éƒ½æ¸‹è°·åŒºâ–³â–³2-3-4
   è·é›¢: 0.35km
   å®šå“¡: 40å
   å¯¾è±¡: 1-5æ­³
   ç‰¹å¾´: å°‘äººæ•°åˆ¶, è‹±èªæ•™è‚², é£Ÿè‚²
   é›»è©±: 03-2345-6789

ã€ã‚ãªãŸã€‘
ã•ãã‚‰ä¿è‚²åœ’ã®è©³ç´°ã‚’æ•™ãˆã¦

ã€Claudeã€‘
[è©³ç´°æƒ…å ±ã‚’è¡¨ç¤º]

ã€ã‚ãªãŸã€‘
å­ä¾›ã®ç”Ÿå¹´æœˆæ—¥ã¯2024-06-15ã€‚
äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦

ã€Claudeã€‘
# äºˆé˜²æ¥ç¨®ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

ç¾åœ¨ã®æœˆé½¢: 6ãƒ¶æœˆ

## ä»Šå¾Œã®äºˆå®š

ãƒ’ãƒ–ãƒ¯ã‚¯ãƒãƒ³
  æ¥ç¨®æ™‚æœŸ: ç”Ÿå¾Œ2ãƒ¶æœˆã€œ
  å›æ•°: 4å›ï¼ˆ4-8é€±é–“éš”ã§3å›ã€è¿½åŠ 1å›ï¼‰
  çŠ¶æ…‹: æ¥ç¨®å¯èƒ½

å°å…ç”¨è‚ºç‚çƒèŒ
  æ¥ç¨®æ™‚æœŸ: ç”Ÿå¾Œ2ãƒ¶æœˆã€œ
  å›æ•°: 4å›ï¼ˆ4é€±é–“éš”ã§3å›ã€è¿½åŠ 1å›ï¼‰
  çŠ¶æ…‹: æ¥ç¨®å¯èƒ½

BCG
  æ¥ç¨®æ™‚æœŸ: ç”Ÿå¾Œ5ãƒ¶æœˆã€œ8ãƒ¶æœˆæœªæº€
  å›æ•°: 1å›
  çŠ¶æ…‹: æ¥ç¨®å¯èƒ½

...
```

---

## ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹2: æ ½åŸ¹ã‚¢ãƒ—ãƒª Ã— MCP

### å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

```
ã€åŸºæœ¬æ©Ÿèƒ½ã€‘ï¼ˆ06-07ç« ã§å®Ÿè£…æ¸ˆã¿ï¼‰
- æ ½åŸ¹è¨˜éŒ²
- è²©å£²ç”¨Webç”Ÿæˆ

ã€MCPçµ±åˆã§è¿½åŠ ã€‘
âœ… ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ°—è±¡ãƒ‡ãƒ¼ã‚¿
âœ… æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ï¼ˆæ°—è±¡æ¡ä»¶ã«åŸºã¥ãï¼‰
âœ… å¸‚å ´ä¾¡æ ¼æƒ…å ±
âœ… æœ€é©ãªå‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ææ¡ˆ
```

---

### ã‚«ã‚¹ã‚¿ãƒ MCP: è¾²æ¥­æ”¯æ´ã‚µãƒ¼ãƒãƒ¼

**agriculture-mcp-server.py**

```python
import asyncio
from typing import Any
from mcp.server import Server
from mcp.server.stdio import stdio_server
from mcp.types import Tool, TextContent
import httpx
from datetime import datetime, timedelta

app = Server("agriculture-support")

# æ°—è±¡ãƒ‡ãƒ¼ã‚¿å–å¾—ï¼ˆOpen-Meteo APIï¼‰
async def get_weather_data(latitude: float, longitude: float):
    async with httpx.AsyncClient() as client:
        response = await client.get(
            "https://api.open-meteo.com/v1/forecast",
            params={
                "latitude": latitude,
                "longitude": longitude,
                "daily": "temperature_2m_max,temperature_2m_min,precipitation_sum,soil_moisture_0_to_10cm",
                "timezone": "Asia/Tokyo",
                "forecast_days": 7
            }
        )
        return response.json()

# æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆ
def generate_cultivation_advice(weather_data: dict, crop: str) -> str:
    daily = weather_data["daily"]
    today = daily["time"][0]
    temp_max = daily["temperature_2m_max"][0]
    temp_min = daily["temperature_2m_min"][0]
    precip = daily["precipitation_sum"][0]
    soil_moisture = daily["soil_moisture_0_to_10cm"][0]

    advice = f"# {today}ã®æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹\n\n"
    advice += f"ä½œç‰©: {crop}\n\n"

    # æ°—æ¸©ã«åŸºã¥ãã‚¢ãƒ‰ãƒã‚¤ã‚¹
    if temp_max > 30:
        advice += "âš ï¸ é«˜æ¸©æ³¨æ„\n"
        advice += "- æœå¤•ã®æ¶¼ã—ã„æ™‚é–“ã«æ°´ã‚„ã‚Š\n"
        advice += "- é®å…‰ãƒãƒƒãƒˆã®ä½¿ç”¨ã‚’æ¤œè¨\n"
        advice += "- è‘‰ç„¼ã‘ã«æ³¨æ„\n\n"
    elif temp_min < 10:
        advice += "âš ï¸ ä½æ¸©æ³¨æ„\n"
        advice += "- éœœå¯¾ç­–ãŒå¿…è¦\n"
        advice += "- ä¸ç¹”å¸ƒã‚„ãƒ“ãƒ‹ãƒ¼ãƒ«ãƒˆãƒ³ãƒãƒ«ã§ä¿æ¸©\n"
        advice += "- æ°´ã‚„ã‚Šã¯åˆå‰ä¸­ã«\n\n"
    else:
        advice += "âœ… æ ½åŸ¹é©æ¸©\n"
        advice += "- é€šå¸¸ã®ç®¡ç†ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“\n\n"

    # é™æ°´é‡ã«åŸºã¥ãã‚¢ãƒ‰ãƒã‚¤ã‚¹
    if precip > 10:
        advice += "â˜” é™é›¨äºˆå ±\n"
        advice += "- æ°´ã‚„ã‚Šä¸è¦\n"
        advice += "- æ’æ°´å¯¾ç­–ã‚’ç¢ºèª\n"
        advice += "- ç—…æ°—äºˆé˜²ï¼ˆé¢¨é€šã—ç¢ºä¿ï¼‰\n\n"
    elif precip > 0:
        advice += "ğŸŒ¦ï¸ å°é›¨äºˆå ±\n"
        advice += "- æ°´ã‚„ã‚Šã¯æ§ãˆã‚ã«\n\n"
    else:
        advice += "â˜€ï¸ æ™´å¤©\n"
        advice += f"- åœŸå£Œæ°´åˆ†: {soil_moisture:.1f}%\n"
        if soil_moisture < 20:
            advice += "- æ°´ã‚„ã‚ŠãŒå¿…è¦ã§ã™\n\n"
        else:
            advice += "- æ°´ã‚„ã‚Šã¯æ§˜å­ã‚’è¦‹ã¦\n\n"

    # ä½œæ¥­ææ¡ˆ
    advice += "## æœ¬æ—¥ã®ä½œæ¥­\n"
    if precip == 0 and temp_max < 30:
        advice += "- é™¤è‰ä½œæ¥­ã«é©ã—ã¦ã„ã¾ã™\n"
        advice += "- è¿½è‚¥ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™\n"
    if temp_max > 25 and crop in ["ãƒˆãƒãƒˆ", "ã‚­ãƒ¥ã‚¦ãƒª"]:
        advice += "- åç©«é©æœŸã§ã™ï¼ˆæœã®æ¶¼ã—ã„æ™‚é–“ã«ï¼‰\n"

    return advice

# å¸‚å ´ä¾¡æ ¼æƒ…å ±ï¼ˆã‚µãƒ³ãƒ—ãƒ«ï¼‰
MARKET_PRICES = {
    "ãƒˆãƒãƒˆ": {"price": 800, "trend": "ä¸Šæ˜‡", "demand": "é«˜"},
    "ã‚­ãƒ¥ã‚¦ãƒª": {"price": 600, "trend": "å®‰å®š", "demand": "ä¸­"},
    "ãƒŠã‚¹": {"price": 700, "trend": "ä¸‹é™", "demand": "ä¸­"},
    "ãƒ”ãƒ¼ãƒãƒ³": {"price": 900, "trend": "ä¸Šæ˜‡", "demand": "é«˜"},
}

@app.list_tools()
async def list_tools() -> list[Tool]:
    return [
        Tool(
            name="get_cultivation_advice",
            description="æ°—è±¡ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ã„ãŸæ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’å–å¾—ã—ã¾ã™",
            inputSchema={
                "type": "object",
                "properties": {
                    "latitude": {"type": "number", "description": "ç·¯åº¦"},
                    "longitude": {"type": "number", "description": "çµŒåº¦"},
                    "crop": {"type": "string", "description": "ä½œç‰©å"}
                },
                "required": ["latitude", "longitude", "crop"]
            }
        ),
        Tool(
            name="get_market_price",
            description="ä½œç‰©ã®å¸‚å ´ä¾¡æ ¼æƒ…å ±ã‚’å–å¾—ã—ã¾ã™",
            inputSchema={
                "type": "object",
                "properties": {
                    "crop": {"type": "string", "description": "ä½œç‰©å"}
                },
                "required": ["crop"]
            }
        ),
        Tool(
            name="suggest_harvest_timing",
            description="æ°—è±¡ã¨å¸‚å ´ä¾¡æ ¼ã‹ã‚‰æœ€é©ãªåç©«ãƒ»å‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ææ¡ˆã—ã¾ã™",
            inputSchema={
                "type": "object",
                "properties": {
                    "latitude": {"type": "number", "description": "ç·¯åº¦"},
                    "longitude": {"type": "number", "description": "çµŒåº¦"},
                    "crop": {"type": "string", "description": "ä½œç‰©å"},
                    "estimated_harvest_date": {
                        "type": "string",
                        "description": "äºˆæƒ³åç©«æ—¥ï¼ˆYYYY-MM-DDï¼‰"
                    }
                },
                "required": ["latitude", "longitude", "crop", "estimated_harvest_date"]
            }
        )
    ]

@app.call_tool()
async def call_tool(name: str, arguments: Any) -> list[TextContent]:
    if name == "get_cultivation_advice":
        lat = arguments["latitude"]
        lon = arguments["longitude"]
        crop = arguments["crop"]

        weather_data = await get_weather_data(lat, lon)
        advice = generate_cultivation_advice(weather_data, crop)

        return [TextContent(type="text", text=advice)]

    elif name == "get_market_price":
        crop = arguments["crop"]
        price_info = MARKET_PRICES.get(crop, {
            "price": 0,
            "trend": "ä¸æ˜",
            "demand": "ä¸æ˜"
        })

        result = f"""
# {crop}ã®å¸‚å ´ä¾¡æ ¼æƒ…å ±

ç¾åœ¨ä¾¡æ ¼: Â¥{price_info['price']}/kg
ä¾¡æ ¼å‹•å‘: {price_info['trend']}
éœ€è¦: {price_info['demand']}

## å‡ºè·ã‚¢ãƒ‰ãƒã‚¤ã‚¹
"""
        if price_info['trend'] == "ä¸Šæ˜‡":
            result += "- ä¾¡æ ¼ä¸Šæ˜‡ä¸­ã§ã™ã€‚å‡ºè·ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨ã—ã¦è‰¯å¥½ã€‚\n"
        elif price_info['trend'] == "ä¸‹é™":
            result += "- ä¾¡æ ¼ä¸‹é™ä¸­ã§ã™ã€‚æ—©ã‚ã®å‡ºè·ã‚’æ¤œè¨ã—ã¦ãã ã•ã„ã€‚\n"
        else:
            result += "- ä¾¡æ ¼ã¯å®‰å®šã—ã¦ã„ã¾ã™ã€‚é€šå¸¸é€šã‚Šã®å‡ºè·ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚\n"

        return [TextContent(type="text", text=result.strip())]

    elif name == "suggest_harvest_timing":
        lat = arguments["latitude"]
        lon = arguments["longitude"]
        crop = arguments["crop"]
        harvest_date = arguments["estimated_harvest_date"]

        weather_data = await get_weather_data(lat, lon)
        price_info = MARKET_PRICES.get(crop, {"price": 0, "trend": "ä¸æ˜"})

        daily = weather_data["daily"]

        result = f"# {crop}ã®åç©«ãƒ»å‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ææ¡ˆ\n\n"
        result += f"äºˆå®šåç©«æ—¥: {harvest_date}\n\n"

        result += "## ä»Šå¾Œ7æ—¥é–“ã®å¤©æ°—\n"
        for i in range(7):
            date = daily["time"][i]
            temp_max = daily["temperature_2m_max"][i]
            precip = daily["precipitation_sum"][i]
            result += f"{date}: æœ€é«˜{temp_max}Â°C, é™æ°´{precip}mm\n"

        result += f"\n## å¸‚å ´ä¾¡æ ¼\n"
        result += f"ç¾åœ¨ä¾¡æ ¼: Â¥{price_info['price']}/kg\n"
        result += f"å‹•å‘: {price_info['trend']}\n\n"

        result += "## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³\n"

        # å¤©æ°—ã¨ä¾¡æ ¼ã‹ã‚‰åˆ¤æ–­
        rainy_days = sum(1 for p in daily["precipitation_sum"][:3] if p > 5)

        if rainy_days > 1:
            result += "âš ï¸ ä»Šå¾Œ3æ—¥é–“ã€é›¨ãŒå¤šã„äºˆå ±ã§ã™ã€‚\n"
            result += "- åç©«ã¯é›¨ã®å‰ã«æ¸ˆã¾ã›ã¾ã—ã‚‡ã†\n"
            result += "- å“è³ªä½ä¸‹ã‚’é˜²ããŸã‚æ—©ã‚ã®å‡ºè·ã‚’æ¨å¥¨\n"
        else:
            result += "âœ… å¤©å€™ã¯å®‰å®šã—ã¦ã„ã¾ã™ã€‚\n"
            result += "- è¨ˆç”»é€šã‚Šã®åç©«ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“\n"

        if price_info['trend'] == "ä¸Šæ˜‡":
            result += "\nğŸ’° ä¾¡æ ¼ä¸Šæ˜‡ä¸­ã§ã™ã€‚\n"
            result += "- å¯èƒ½ã§ã‚ã‚Œã°æ•°æ—¥å¾…ã¤ã¨è‰¯ã„ä¾¡æ ¼ã§å‡ºè·ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™\n"
        elif price_info['trend'] == "ä¸‹é™":
            result += "\nğŸ“‰ ä¾¡æ ¼ä¸‹é™ä¸­ã§ã™ã€‚\n"
            result += "- æ—©ã‚ã®å‡ºè·ã‚’ãŠå‹§ã‚ã—ã¾ã™\n"

        return [TextContent(type="text", text=result)]

    else:
        raise ValueError(f"Unknown tool: {name}")

async def main():
    async with stdio_server() as (read_stream, write_stream):
        await app.run(
            read_stream,
            write_stream,
            app.create_initialization_options()
        )

if __name__ == "__main__":
    asyncio.run(main())
```

---

### æ ½åŸ¹ã‚¢ãƒ—ãƒªã§ã®MCPæ´»ç”¨

```
ã€ã‚ãªãŸã€‘
ç•‘ã®ä½ç½®ï¼ˆç·¯åº¦35.6586ã€çµŒåº¦139.7454ï¼‰ã§
ãƒˆãƒãƒˆã‚’è‚²ã¦ã¦ã„ã‚‹ã‚“ã ã‘ã©ã€ä»Šæ—¥ã®æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’æ•™ãˆã¦

ã€Claudeã€‘
Agriculture Support MCPã‚’ä½¿ã£ã¦æ°—è±¡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€
æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™...

# 2025-12-22ã®æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹

ä½œç‰©: ãƒˆãƒãƒˆ

âœ… æ ½åŸ¹é©æ¸©
- é€šå¸¸ã®ç®¡ç†ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“

â˜€ï¸ æ™´å¤©
- åœŸå£Œæ°´åˆ†: 15.2%
- æ°´ã‚„ã‚ŠãŒå¿…è¦ã§ã™

## æœ¬æ—¥ã®ä½œæ¥­
- é™¤è‰ä½œæ¥­ã«é©ã—ã¦ã„ã¾ã™
- è¿½è‚¥ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã™
- åç©«é©æœŸã§ã™ï¼ˆæœã®æ¶¼ã—ã„æ™‚é–“ã«ï¼‰

ã€ã‚ãªãŸã€‘
ãƒˆãƒãƒˆã®å¸‚å ´ä¾¡æ ¼ã‚‚æ•™ãˆã¦

ã€Claudeã€‘
# ãƒˆãƒãƒˆã®å¸‚å ´ä¾¡æ ¼æƒ…å ±

ç¾åœ¨ä¾¡æ ¼: Â¥800/kg
ä¾¡æ ¼å‹•å‘: ä¸Šæ˜‡
éœ€è¦: é«˜

## å‡ºè·ã‚¢ãƒ‰ãƒã‚¤ã‚¹
- ä¾¡æ ¼ä¸Šæ˜‡ä¸­ã§ã™ã€‚å‡ºè·ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã¨ã—ã¦è‰¯å¥½ã€‚

ã€ã‚ãªãŸã€‘
åç©«äºˆå®šã¯12æœˆ25æ—¥ã€‚æœ€é©ãªå‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã‚’ææ¡ˆã—ã¦

ã€Claudeã€‘
# ãƒˆãƒãƒˆã®åç©«ãƒ»å‡ºè·ã‚¿ã‚¤ãƒŸãƒ³ã‚°ææ¡ˆ

äºˆå®šåç©«æ—¥: 2025-12-25

## ä»Šå¾Œ7æ—¥é–“ã®å¤©æ°—
2025-12-22: æœ€é«˜16Â°C, é™æ°´0mm
2025-12-23: æœ€é«˜14Â°C, é™æ°´0mm
2025-12-24: æœ€é«˜15Â°C, é™æ°´2mm
2025-12-25: æœ€é«˜13Â°C, é™æ°´8mm
2025-12-26: æœ€é«˜12Â°C, é™æ°´12mm
2025-12-27: æœ€é«˜14Â°C, é™æ°´0mm
2025-12-28: æœ€é«˜15Â°C, é™æ°´0mm

## å¸‚å ´ä¾¡æ ¼
ç¾åœ¨ä¾¡æ ¼: Â¥800/kg
å‹•å‘: ä¸Šæ˜‡

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
âš ï¸ ä»Šå¾Œ3æ—¥é–“ã€é›¨ãŒå¤šã„äºˆå ±ã§ã™ã€‚
- åç©«ã¯é›¨ã®å‰ã«æ¸ˆã¾ã›ã¾ã—ã‚‡ã†
- å“è³ªä½ä¸‹ã‚’é˜²ããŸã‚æ—©ã‚ã®å‡ºè·ã‚’æ¨å¥¨

ğŸ’° ä¾¡æ ¼ä¸Šæ˜‡ä¸­ã§ã™ã€‚
- å¯èƒ½ã§ã‚ã‚Œã°æ•°æ—¥å¾…ã¤ã¨è‰¯ã„ä¾¡æ ¼ã§å‡ºè·ã§ãã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™

**ææ¡ˆ: 12æœˆ24æ—¥ï¼ˆé›¨ã®å‰ï¼‰ã«åç©«ã—ã€12æœˆ27æ—¥ï¼ˆä¾¡æ ¼å®‰å®šå¾Œï¼‰ã«å‡ºè·**
```

---

## ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹3: å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒª Ã— MCP

### å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

```
ã€åŸºæœ¬æ©Ÿèƒ½ã€‘ï¼ˆ06-07ç« ã§å®Ÿè£…æ¸ˆã¿ï¼‰
- åæ”¯è¨˜éŒ²
- æŠ•è³‡åˆ†æ

ã€MCPçµ±åˆã§è¿½åŠ ã€‘
âœ… æ ªä¾¡ãƒ»ç‚ºæ›¿ã®è‡ªå‹•æ›´æ–°
âœ… çµŒæ¸ˆãƒ‹ãƒ¥ãƒ¼ã‚¹ã®çµ±åˆ
âœ… ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªæœ€é©åŒ–ææ¡ˆ
âœ… ãƒªã‚¹ã‚¯åˆ†æ
```

---

### ã‚«ã‚¹ã‚¿ãƒ MCP: é‡‘èãƒ‡ãƒ¼ã‚¿ã‚µãƒ¼ãƒãƒ¼

**finance-mcp-server.ts**

```typescript
import { Server } from '@modelcontextprotocol/sdk/server/index.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';
import {
  CallToolRequestSchema,
  ListToolsRequestSchema,
} from '@modelcontextprotocol/sdk/types.js';

// æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã¯Yahoo Financeã‚„Alpha Vantage APIã‚’ä½¿ç”¨ï¼‰
interface StockPrice {
  symbol: string;
  price: number;
  change: number;
  changePercent: number;
  volume: number;
}

// ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
const mockStockData: { [key: string]: StockPrice } = {
  'AAPL': {
    symbol: 'AAPL',
    price: 195.50,
    change: 2.30,
    changePercent: 1.19,
    volume: 50000000,
  },
  'GOOGL': {
    symbol: 'GOOGL',
    price: 142.80,
    change: -0.50,
    changePercent: -0.35,
    volume: 25000000,
  },
  'MSFT': {
    symbol: 'MSFT',
    price: 378.90,
    change: 5.20,
    changePercent: 1.39,
    volume: 35000000,
  },
};

// ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆï¼ˆå®Ÿéš›ã¯FX APIã‚’ä½¿ç”¨ï¼‰
const exchangeRates: { [key: string]: number } = {
  'USD/JPY': 155.50,
  'EUR/JPY': 168.20,
  'GBP/JPY': 195.80,
};

const server = new Server(
  {
    name: 'finance-data',
    version: '1.0.0',
  },
  {
    capabilities: {
      tools: {},
    },
  }
);

server.setRequestHandler(ListToolsRequestSchema, async () => {
  return {
    tools: [
      {
        name: 'get_stock_price',
        description: 'æ ªä¾¡æƒ…å ±ã‚’å–å¾—ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            symbol: {
              type: 'string',
              description: 'ãƒ†ã‚£ãƒƒã‚«ãƒ¼ã‚·ãƒ³ãƒœãƒ«ï¼ˆä¾‹: AAPL, GOOGLï¼‰',
            },
          },
          required: ['symbol'],
        },
      },
      {
        name: 'get_exchange_rate',
        description: 'ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã‚’å–å¾—ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            pair: {
              type: 'string',
              description: 'é€šè²¨ãƒšã‚¢ï¼ˆä¾‹: USD/JPYï¼‰',
            },
          },
          required: ['pair'],
        },
      },
      {
        name: 'analyze_portfolio',
        description: 'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’åˆ†æã—ã€ãƒªã‚¹ã‚¯ã¨ãƒªã‚¿ãƒ¼ãƒ³ã‚’è©•ä¾¡ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            holdings: {
              type: 'array',
              items: {
                type: 'object',
                properties: {
                  symbol: { type: 'string' },
                  shares: { type: 'number' },
                  avgCost: { type: 'number' },
                },
              },
              description: 'ä¿æœ‰éŠ˜æŸ„ãƒªã‚¹ãƒˆ',
            },
          },
          required: ['holdings'],
        },
      },
      {
        name: 'suggest_rebalancing',
        description: 'ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®ãƒªãƒãƒ©ãƒ³ã‚¹ææ¡ˆã‚’ç”Ÿæˆã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            currentAllocation: {
              type: 'object',
              description: 'ç¾åœ¨ã®è³‡ç”£é…åˆ†ï¼ˆï¼…ï¼‰',
            },
            targetAllocation: {
              type: 'object',
              description: 'ç›®æ¨™ã®è³‡ç”£é…åˆ†ï¼ˆï¼…ï¼‰',
            },
            totalValue: {
              type: 'number',
              description: 'ç·è³‡ç”£é¡',
            },
          },
          required: ['currentAllocation', 'targetAllocation', 'totalValue'],
        },
      },
    ],
  };
});

server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name, arguments: args } = request.params;

  switch (name) {
    case 'get_stock_price': {
      const symbol = (args.symbol as string).toUpperCase();
      const stock = mockStockData[symbol];

      if (!stock) {
        throw new Error(`æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${symbol}`);
      }

      const result = `
# ${stock.symbol} æ ªä¾¡æƒ…å ±

ç¾åœ¨å€¤: $${stock.price.toFixed(2)}
å¤‰å‹•: ${stock.change >= 0 ? '+' : ''}${stock.change.toFixed(2)} (${
        stock.change >= 0 ? '+' : ''
      }${stock.changePercent.toFixed(2)}%)
å‡ºæ¥é«˜: ${stock.volume.toLocaleString()}

${stock.changePercent > 0 ? 'ğŸ“ˆ ä¸Šæ˜‡ä¸­' : 'ğŸ“‰ ä¸‹è½ä¸­'}
      `.trim();

      return {
        content: [{ type: 'text', text: result }],
      };
    }

    case 'get_exchange_rate': {
      const pair = args.pair as string;
      const rate = exchangeRates[pair];

      if (!rate) {
        throw new Error(`ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ${pair}`);
      }

      const result = `
# ${pair} ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆ

ç¾åœ¨ãƒ¬ãƒ¼ãƒˆ: Â¥${rate.toFixed(2)}

ã€æ´»ç”¨ä¾‹ã€‘
$100 = Â¥${(100 * rate).toFixed(0)}
$1,000 = Â¥${(1000 * rate).toFixed(0)}
      `.trim();

      return {
        content: [{ type: 'text', text: result }],
      };
    }

    case 'analyze_portfolio': {
      const holdings = args.holdings as Array<{
        symbol: string;
        shares: number;
        avgCost: number;
      }>;

      let totalValue = 0;
      let totalCost = 0;
      const analysis: string[] = [];

      for (const holding of holdings) {
        const stock = mockStockData[holding.symbol];
        if (!stock) continue;

        const currentValue = stock.price * holding.shares;
        const cost = holding.avgCost * holding.shares;
        const gain = currentValue - cost;
        const gainPercent = (gain / cost) * 100;

        totalValue += currentValue;
        totalCost += cost;

        analysis.push(`
${holding.symbol}
  ä¿æœ‰æ•°: ${holding.shares}æ ª
  å¹³å‡å–å¾—å˜ä¾¡: $${holding.avgCost.toFixed(2)}
  ç¾åœ¨ä¾¡æ ¼: $${stock.price.toFixed(2)}
  è©•ä¾¡é¡: $${currentValue.toFixed(2)}
  æç›Š: ${gain >= 0 ? '+' : ''}$${gain.toFixed(2)} (${
          gain >= 0 ? '+' : ''
        }${gainPercent.toFixed(2)}%)
        `.trim());
      }

      const totalGain = totalValue - totalCost;
      const totalGainPercent = (totalGain / totalCost) * 100;

      const result = `
# ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ†æ

## ä¿æœ‰éŠ˜æŸ„

${analysis.join('\n\n')}

## å…¨ä½“ã‚µãƒãƒªãƒ¼

ç·è©•ä¾¡é¡: $${totalValue.toFixed(2)}
ç·æŠ•è³‡é¡: $${totalCost.toFixed(2)}
ç·æç›Š: ${totalGain >= 0 ? '+' : ''}$${totalGain.toFixed(2)} (${
        totalGain >= 0 ? '+' : ''
      }${totalGainPercent.toFixed(2)}%)

${totalGain > 0 ? 'âœ… åˆ©ç›ŠãŒå‡ºã¦ã„ã¾ã™' : 'âš ï¸ å«ã¿æãŒã‚ã‚Šã¾ã™'}
      `.trim();

      return {
        content: [{ type: 'text', text: result }],
      };
    }

    case 'suggest_rebalancing': {
      const current = args.currentAllocation as { [key: string]: number };
      const target = args.targetAllocation as { [key: string]: number };
      const total = args.totalValue as number;

      const suggestions: string[] = [];

      for (const asset in target) {
        const currentPercent = current[asset] || 0;
        const targetPercent = target[asset];
        const diff = targetPercent - currentPercent;

        if (Math.abs(diff) > 5) {
          // 5%ä»¥ä¸Šã®ãšã‚Œ
          const amount = (total * diff) / 100;

          if (diff > 0) {
            suggestions.push(
              `${asset}: ${amount.toFixed(0)}å†† è²·ã„å¢—ã—ï¼ˆ${currentPercent.toFixed(
                1
              )}% â†’ ${targetPercent.toFixed(1)}%ï¼‰`
            );
          } else {
            suggestions.push(
              `${asset}: ${Math.abs(amount).toFixed(
                0
              )}å†† å£²å´ï¼ˆ${currentPercent.toFixed(1)}% â†’ ${targetPercent.toFixed(
                1
              )}%ï¼‰`
            );
          }
        }
      }

      const result = `
# ãƒªãƒãƒ©ãƒ³ã‚¹ææ¡ˆ

ç·è³‡ç”£: Â¥${total.toLocaleString()}

## ç¾åœ¨ã®é…åˆ†
${Object.entries(current)
  .map(([k, v]) => `- ${k}: ${v.toFixed(1)}%`)
  .join('\n')}

## ç›®æ¨™é…åˆ†
${Object.entries(target)
  .map(([k, v]) => `- ${k}: ${v.toFixed(1)}%`)
  .join('\n')}

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
${suggestions.length > 0 ? suggestions.join('\n') : 'ç¾åœ¨ã®é…åˆ†ã¯ç›®æ¨™ã«è¿‘ã„çŠ¶æ…‹ã§ã™ã€‚'}

## æ³¨æ„äº‹é …
- ãƒªãƒãƒ©ãƒ³ã‚¹ã¯æ‰‹æ•°æ–™ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„
- ä¸€åº¦ã«å…¨ã¦èª¿æ•´ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“
- å¸‚å ´ç’°å¢ƒã‚’è¦‹ãªãŒã‚‰æ®µéšçš„ã«å®Ÿæ–½ã—ã¾ã—ã‚‡ã†
      `.trim();

      return {
        content: [{ type: 'text', text: result }],
      };
    }

    default:
      throw new Error(`Unknown tool: ${name}`);
  }
});

async function main() {
  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.error('Finance Data MCP Server running');
}

main().catch(console.error);
```

---

### å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒªã§ã®MCPæ´»ç”¨

```
ã€ã‚ãªãŸã€‘
AAPLã®ç¾åœ¨ã®æ ªä¾¡ã‚’æ•™ãˆã¦

ã€Claudeã€‘
Finance Data MCPã§æ ªä¾¡ã‚’å–å¾—ã—ã¾ã™...

# AAPL æ ªä¾¡æƒ…å ±

ç¾åœ¨å€¤: $195.50
å¤‰å‹•: +$2.30 (+1.19%)
å‡ºæ¥é«˜: 50,000,000

ğŸ“ˆ ä¸Šæ˜‡ä¸­

ã€ã‚ãªãŸã€‘
ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã‚’åˆ†æã—ã¦ã€‚
AAPL 10æ ªï¼ˆå¹³å‡$180ï¼‰ã€GOOGL 5æ ªï¼ˆå¹³å‡$145ï¼‰æŒã£ã¦ã‚‹

ã€Claudeã€‘
# ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªåˆ†æ

## ä¿æœ‰éŠ˜æŸ„

AAPL
  ä¿æœ‰æ•°: 10æ ª
  å¹³å‡å–å¾—å˜ä¾¡: $180.00
  ç¾åœ¨ä¾¡æ ¼: $195.50
  è©•ä¾¡é¡: $1,955.00
  æç›Š: +$155.00 (+8.61%)

GOOGL
  ä¿æœ‰æ•°: 5æ ª
  å¹³å‡å–å¾—å˜ä¾¡: $145.00
  ç¾åœ¨ä¾¡æ ¼: $142.80
  è©•ä¾¡é¡: $714.00
  æç›Š: -$11.00 (-1.52%)

## å…¨ä½“ã‚µãƒãƒªãƒ¼

ç·è©•ä¾¡é¡: $2,669.00
ç·æŠ•è³‡é¡: $2,525.00
ç·æç›Š: +$144.00 (+5.70%)

âœ… åˆ©ç›ŠãŒå‡ºã¦ã„ã¾ã™

ã€ã‚ãªãŸã€‘
ç›®æ¨™é…åˆ†ã¯æ ªå¼60%ã€å‚µåˆ¸30%ã€ç¾é‡‘10%ã€‚
ç¾åœ¨ã¯æ ªå¼75%ã€å‚µåˆ¸20%ã€ç¾é‡‘5%ã§ã€ç·è³‡ç”£300ä¸‡å††ã€‚
ãƒªãƒãƒ©ãƒ³ã‚¹ææ¡ˆã—ã¦

ã€Claudeã€‘
# ãƒªãƒãƒ©ãƒ³ã‚¹ææ¡ˆ

ç·è³‡ç”£: Â¥3,000,000

## ç¾åœ¨ã®é…åˆ†
- æ ªå¼: 75.0%
- å‚µåˆ¸: 30.0%
- ç¾é‡‘: 5.0%

## ç›®æ¨™é…åˆ†
- æ ªå¼: 60.0%
- å‚µåˆ¸: 30.0%
- ç¾é‡‘: 10.0%

## æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
æ ªå¼: 450,000å†† å£²å´ï¼ˆ75.0% â†’ 60.0%ï¼‰
å‚µåˆ¸: 300,000å†† è²·ã„å¢—ã—ï¼ˆ20.0% â†’ 30.0%ï¼‰
ç¾é‡‘: 150,000å†† è²·ã„å¢—ã—ï¼ˆ5.0% â†’ 10.0%ï¼‰

## æ³¨æ„äº‹é …
- ãƒªãƒãƒ©ãƒ³ã‚¹ã¯æ‰‹æ•°æ–™ã‚’è€ƒæ…®ã—ã¦ãã ã•ã„
- ä¸€åº¦ã«å…¨ã¦èª¿æ•´ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“
- å¸‚å ´ç’°å¢ƒã‚’è¦‹ãªãŒã‚‰æ®µéšçš„ã«å®Ÿæ–½ã—ã¾ã—ã‚‡ã†
```

---

## ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹4: èª­æ›¸ã‚¢ãƒ—ãƒª Ã— MCP

### å®Ÿè£…ã™ã‚‹æ©Ÿèƒ½

```
ã€åŸºæœ¬æ©Ÿèƒ½ã€‘ï¼ˆ06-07ç« ã§å®Ÿè£…æ¸ˆã¿ï¼‰
- èª­æ›¸è¨˜éŒ²
- æ›¸è©•ãƒ–ãƒ­ã‚°è‡ªå‹•ç”Ÿæˆ

ã€MCPçµ±åˆã§è¿½åŠ ã€‘
âœ… æ›¸ç±æƒ…å ±APIé€£æºï¼ˆGoogle Booksç­‰ï¼‰
âœ… æ›¸ç±ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®åé›†
âœ… ãŠã™ã™ã‚æœ¬ã®ææ¡ˆ
âœ… èª­æ›¸å‚¾å‘ã®åˆ†æ
```

---

### ã‚«ã‚¹ã‚¿ãƒ MCP: æ›¸ç±æƒ…å ±ã‚µãƒ¼ãƒãƒ¼

**book-info-mcp-server.ts**

```typescript
import { Server } from '@modelcontextprotocol/sdk/server/index.js';
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js';
import {
  CallToolRequestSchema,
  ListToolsRequestSchema,
} from '@modelcontextprotocol/sdk/types.js';

const server = new Server(
  {
    name: 'book-info',
    version: '1.0.0',
  },
  {
    capabilities: {
      tools: {},
    },
  }
);

server.setRequestHandler(ListToolsRequestSchema, async () => {
  return {
    tools: [
      {
        name: 'search_books',
        description: 'æ›¸ç±ã‚’æ¤œç´¢ã—ã¾ã™ï¼ˆGoogle Books APIä½¿ç”¨ï¼‰',
        inputSchema: {
          type: 'object',
          properties: {
            query: {
              type: 'string',
              description: 'æ¤œç´¢ã‚¯ã‚¨ãƒªï¼ˆã‚¿ã‚¤ãƒˆãƒ«ã€è‘—è€…ã€ISBNç­‰ï¼‰',
            },
            maxResults: {
              type: 'number',
              description: 'æœ€å¤§çµæœæ•°',
              default: 5,
            },
          },
          required: ['query'],
        },
      },
      {
        name: 'get_book_details',
        description: 'æ›¸ç±ã®è©³ç´°æƒ…å ±ã‚’å–å¾—ã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            bookId: {
              type: 'string',
              description: 'Google Books ID',
            },
          },
          required: ['bookId'],
        },
      },
      {
        name: 'recommend_books',
        description: 'èª­æ›¸å±¥æ­´ã«åŸºã¥ã„ã¦ãŠã™ã™ã‚ã®æœ¬ã‚’ææ¡ˆã—ã¾ã™',
        inputSchema: {
          type: 'object',
          properties: {
            readBooks: {
              type: 'array',
              items: { type: 'string' },
              description: 'æ—¢èª­æ›¸ç±ã®ã‚¿ã‚¤ãƒˆãƒ«ãƒªã‚¹ãƒˆ',
            },
            genres: {
              type: 'array',
              items: { type: 'string' },
              description: 'å¥½ããªã‚¸ãƒ£ãƒ³ãƒ«',
            },
          },
          required: ['readBooks'],
        },
      },
    ],
  };
});

server.setRequestHandler(CallToolRequestSchema, async (request) => {
  const { name, arguments: args } = request.params;

  switch (name) {
    case 'search_books': {
      const query = args.query as string;
      const maxResults = (args.maxResults as number) || 5;

      // Google Books APIå‘¼ã³å‡ºã—ï¼ˆå®Ÿéš›ã®å®Ÿè£…ï¼‰
      const response = await fetch(
        `https://www.googleapis.com/books/v1/volumes?q=${encodeURIComponent(
          query
        )}&maxResults=${maxResults}`
      );

      const data = await response.json();

      if (!data.items || data.items.length === 0) {
        return {
          content: [
            { type: 'text', text: 'æ¤œç´¢çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ' },
          ],
        };
      }

      const results = data.items
        .map((item: any, index: number) => {
          const info = item.volumeInfo;
          return `
${index + 1}. ${info.title}
   è‘—è€…: ${info.authors?.join(', ') || 'ä¸æ˜'}
   å‡ºç‰ˆç¤¾: ${info.publisher || 'ä¸æ˜'}
   å‡ºç‰ˆæ—¥: ${info.publishedDate || 'ä¸æ˜'}
   ${info.description ? `æ¦‚è¦: ${info.description.substring(0, 100)}...` : ''}
   ID: ${item.id}
          `.trim();
        })
        .join('\n\n');

      return {
        content: [{ type: 'text', text: results }],
      };
    }

    case 'get_book_details': {
      const bookId = args.bookId as string;

      const response = await fetch(
        `https://www.googleapis.com/books/v1/volumes/${bookId}`
      );

      const data = await response.json();
      const info = data.volumeInfo;

      const details = `
# ${info.title}

## åŸºæœ¬æƒ…å ±
- è‘—è€…: ${info.authors?.join(', ') || 'ä¸æ˜'}
- å‡ºç‰ˆç¤¾: ${info.publisher || 'ä¸æ˜'}
- å‡ºç‰ˆæ—¥: ${info.publishedDate || 'ä¸æ˜'}
- ãƒšãƒ¼ã‚¸æ•°: ${info.pageCount || 'ä¸æ˜'}
- ISBN: ${info.industryIdentifiers?.find((id: any) => id.type === 'ISBN_13')?.identifier || 'ä¸æ˜'}

## ã‚«ãƒ†ã‚´ãƒª
${info.categories?.join(', ') || 'ãªã—'}

## æ¦‚è¦
${info.description || 'æ¦‚è¦ãªã—'}

## ãƒªãƒ³ã‚¯
${info.infoLink || 'ãªã—'}
      `.trim();

      return {
        content: [{ type: 'text', text: details }],
      };
    }

    case 'recommend_books': {
      const readBooks = args.readBooks as string[];
      const genres = (args.genres as string[]) || [];

      // ç°¡æ˜“çš„ãªãƒ¬ã‚³ãƒ¡ãƒ³ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå®Ÿéš›ã¯MLç­‰ã‚’ä½¿ç”¨ï¼‰
      const recommendations = `
# ãŠã™ã™ã‚æœ¬ã®ææ¡ˆ

## ã‚ãªãŸã®èª­æ›¸å‚¾å‘
æ—¢èª­æ›¸ç±: ${readBooks.length}å†Š
${genres.length > 0 ? `å¥½ããªã‚¸ãƒ£ãƒ³ãƒ«: ${genres.join(', ')}` : ''}

## ãŠã™ã™ã‚ç†ç”±
æ—¢èª­æ›¸ç±ã®å‚¾å‘ã‹ã‚‰ã€ä»¥ä¸‹ã®ã‚¸ãƒ£ãƒ³ãƒ«ãŒãŠå¥½ããªã‚ˆã†ã§ã™:
- æŠ€è¡“æ›¸ / ãƒ“ã‚¸ãƒã‚¹æ›¸

## ãŠã™ã™ã‚æ›¸ç±
1. "Clean Code" - Robert C. Martin
   ç†ç”±: ã‚³ãƒ¼ãƒ‰å“è³ªã«é–¢å¿ƒãŒã‚ã‚‹æ–¹ã«ãŠã™ã™ã‚

2. "The Pragmatic Programmer" - Andrew Hunt, David Thomas
   ç†ç”±: å®Ÿè·µçš„ãªãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å“²å­¦

3. "Domain-Driven Design" - Eric Evans
   ç†ç”±: ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢è¨­è¨ˆã®æ·±ã„ç†è§£

â€» ã“ã‚Œã‚‰ã®æœ¬ã‚’æ¤œç´¢ã—ã¦è©³ç´°ã‚’ç¢ºèªã§ãã¾ã™
      `.trim();

      return {
        content: [{ type: 'text', text: recommendations }],
      };
    }

    default:
      throw new Error(`Unknown tool: ${name}`);
  }
});

async function main() {
  const transport = new StdioServerTransport();
  await server.connect(transport);
  console.error('Book Info MCP Server running');
}

main().catch(console.error);
```

---

## è¤‡æ•°MCPã®çµ„ã¿åˆã‚ã›ãƒ‘ã‚¿ãƒ¼ãƒ³

### ãƒ‘ã‚¿ãƒ¼ãƒ³1: ãƒ‡ãƒ¼ã‚¿é€£æº

```
ã€è‚²å…ã‚¢ãƒ—ãƒª + è¤‡æ•°MCPã€‘

Nursery MCP
  â†“
ä¿è‚²åœ’æƒ…å ±å–å¾—
  â†“
Weather MCP
  â†“
ä»Šæ—¥ã®å¤©æ°—ç¢ºèª
  â†“
çµ±åˆã‚¢ãƒ‰ãƒã‚¤ã‚¹:
ã€Œä»Šæ—¥ã¯é›¨ãªã®ã§ã€ä¿è‚²åœ’ã¾ã§ã®ç§»å‹•ã¯
 ãƒ¬ã‚¤ãƒ³ã‚³ãƒ¼ãƒˆã‚’å¿˜ã‚Œãšã«ã€‚
 ã•ãã‚‰ä¿è‚²åœ’ï¼ˆå¾’æ­©5åˆ†ï¼‰ãŒæœ€å¯„ã‚Šã§ã™ã€‚ã€
```

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªå‹•åŒ–

```
ã€æ ½åŸ¹ã‚¢ãƒ—ãƒª + è¤‡æ•°MCPã€‘

Agriculture MCP â†’ æ ½åŸ¹ã‚¢ãƒ‰ãƒã‚¤ã‚¹å–å¾—
  â†“
Weather MCP â†’ ä»Šå¾Œã®å¤©æ°—ç¢ºèª
  â†“
Market MCP â†’ å¸‚å ´ä¾¡æ ¼å–å¾—
  â†“
Task Manager MCP â†’ ä½œæ¥­ã‚¿ã‚¹ã‚¯è‡ªå‹•ç”Ÿæˆ
  â†“
ã€Œä»Šæ—¥ã®ä½œæ¥­ãƒªã‚¹ãƒˆã€ãŒè‡ªå‹•ã§å®Œæˆ
```

---

### ãƒ‘ã‚¿ãƒ¼ãƒ³3: æ„æ€æ±ºå®šæ”¯æ´

```
ã€æŠ•è³‡åˆ¤æ–­ + è¤‡æ•°MCPã€‘

Finance MCP â†’ æ ªä¾¡ãƒ»ç‚ºæ›¿å–å¾—
  â†“
News MCP â†’ çµŒæ¸ˆãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—
  â†“
Analysis MCP â†’ ãƒªã‚¹ã‚¯åˆ†æ
  â†“
ç·åˆåˆ¤æ–­:
ã€Œç¾åœ¨ã®å¸‚å ´ç’°å¢ƒã§ã¯ã€ãƒªãƒãƒ©ãƒ³ã‚¹ã¯
 1ãƒ¶æœˆå¾ŒãŒé©åˆ‡ã§ã™ã€‚ç†ç”±ã¯...ã€
```

---

## MCPãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼ˆå®Ÿè·µç·¨ï¼‰

### 1. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

```typescript
// å¤–éƒ¨APIå‘¼ã³å‡ºã—æ™‚ã®å …ç‰¢ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
async function fetchWithRetry(url: string, retries = 3): Promise<any> {
  for (let i = 0; i < retries; i++) {
    try {
      const response = await fetch(url);

      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      return await response.json();
    } catch (error) {
      console.error(`Attempt ${i + 1} failed:`, error);

      if (i === retries - 1) {
        throw new Error(
          `Failed after ${retries} attempts: ${(error as Error).message}`
        );
      }

      // æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•
      await new Promise((resolve) => setTimeout(resolve, 1000 * Math.pow(2, i)));
    }
  }
}
```

---

### 2. ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

```typescript
// ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã§ API å‘¼ã³å‡ºã—ã‚’å‰Šæ¸›
class DataCache {
  private cache: Map<string, { data: any; expiry: number }> = new Map();

  set(key: string, data: any, ttlMs: number = 300000) {
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ5åˆ†
    this.cache.set(key, {
      data,
      expiry: Date.now() + ttlMs,
    });
  }

  get(key: string): any | null {
    const item = this.cache.get(key);
    if (!item) return null;

    if (Date.now() > item.expiry) {
      this.cache.delete(key);
      return null;
    }

    return item.data;
  }
}

const cache = new DataCache();

// ä½¿ç”¨ä¾‹
async function getStockPrice(symbol: string) {
  const cached = cache.get(`stock:${symbol}`);
  if (cached) {
    console.error('Cache hit:', symbol);
    return cached;
  }

  const data = await fetchStockData(symbol);
  cache.set(`stock:${symbol}`, data, 60000); // 1åˆ†ã‚­ãƒ£ãƒƒã‚·ãƒ¥
  return data;
}
```

---

### 3. ãƒ¬ãƒ¼ãƒˆåˆ¶é™

```typescript
// APIãƒ¬ãƒ¼ãƒˆåˆ¶é™ã®éµå®ˆ
class RateLimiter {
  private requests: number[] = [];
  private limit: number;
  private windowMs: number;

  constructor(limit: number, windowMs: number) {
    this.limit = limit;
    this.windowMs = windowMs;
  }

  async acquire(): Promise<void> {
    const now = Date.now();
    this.requests = this.requests.filter((time) => now - time < this.windowMs);

    if (this.requests.length >= this.limit) {
      const oldestRequest = this.requests[0];
      const waitTime = this.windowMs - (now - oldestRequest);
      console.error(`Rate limit reached, waiting ${waitTime}ms`);
      await new Promise((resolve) => setTimeout(resolve, waitTime));
      return this.acquire();
    }

    this.requests.push(now);
  }
}

// ä½¿ç”¨ä¾‹: 1åˆ†é–“ã«10ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¾ã§
const limiter = new RateLimiter(10, 60000);

async function apiCall() {
  await limiter.acquire();
  // APIå‘¼ã³å‡ºã—
}
```

---

## ã¾ã¨ã‚

### BYOAã‚¢ãƒ—ãƒªã®é€²åŒ–ã®å…¨ä½“åƒ

```
ã€06ç« ã€‘å€‹äººç”¨ã‚¢ãƒ—ãƒªä½œæˆ
- ãƒãƒ£ãƒƒãƒˆã®ã¿
- LocalStorage
- åŸºæœ¬æ©Ÿèƒ½

â†“

ã€07ç« ã€‘ã‚³ãƒ©ãƒœã§é€²åŒ–
- ç‰¹åŒ–å‹æ©Ÿèƒ½è¿½åŠ 
- ãƒ‡ãƒ¼ã‚¿æ´»ç”¨
- ç‹¬è‡ªã®ä¾¡å€¤

â†“

ã€08ç« ã€‘MCPåŸºç¤
- MCPã®æ¦‚å¿µ
- æ—¢å­˜MCPã‚µãƒ¼ãƒãƒ¼æ´»ç”¨
- ã‚«ã‚¹ã‚¿ãƒ MCPä½œæˆ

â†“

ã€09ç« ã€‘MCPå®Ÿè·µï¼ˆã“ã®ç« ï¼‰
âœ… è‚²å…ã‚¢ãƒ—ãƒª Ã— ä¿è‚²åœ’æƒ…å ±ãƒ»äºˆé˜²æ¥ç¨®MCP
âœ… æ ½åŸ¹ã‚¢ãƒ—ãƒª Ã— æ°—è±¡ãƒ»å¸‚å ´ä¾¡æ ¼MCP
âœ… å®¶è¨ˆç°¿ã‚¢ãƒ—ãƒª Ã— é‡‘èãƒ‡ãƒ¼ã‚¿MCP
âœ… èª­æ›¸ã‚¢ãƒ—ãƒª Ã— æ›¸ç±æƒ…å ±MCP
âœ… è¤‡æ•°MCPã®çµ„ã¿åˆã‚ã›
âœ… å®Ÿè·µçš„ãªãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

â†“

ã€05ç«  / Chef's Specialsã€‘æœ¬æ ¼é–‹ç™ºã¸
- Cursor + Claude
- Flutter
- CI/CD
```

---

### MCPãŒå®Ÿç¾ã™ã‚‹ä¾¡å€¤

```
ã€ãƒ‡ãƒ¼ã‚¿é€£æºã€‘
å¤–éƒ¨ã‚·ã‚¹ãƒ†ãƒ ã¨ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«çµ±åˆ
â†’ æ‰‹å‹•å…¥åŠ›ã®å‰Šæ¸›
â†’ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªæƒ…å ±

ã€å°‚é–€æ€§ã®è¿½åŠ ã€‘
ãƒ‰ãƒ¡ã‚¤ãƒ³å›ºæœ‰ã®çŸ¥è­˜ã‚’çµ±åˆ
â†’ ä¿è‚²åœ’æƒ…å ±
â†’ æ°—è±¡ãƒ‡ãƒ¼ã‚¿
â†’ å¸‚å ´ä¾¡æ ¼
â†’ é‡‘èãƒ‡ãƒ¼ã‚¿

ã€æ„æ€æ±ºå®šæ”¯æ´ã€‘
è¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’çµ±åˆ
â†’ æœ€é©ãªã‚¿ã‚¤ãƒŸãƒ³ã‚°ææ¡ˆ
â†’ ãƒªã‚¹ã‚¯åˆ†æ
â†’ ç·åˆçš„ãªåˆ¤æ–­

ã€è‡ªå‹•åŒ–ã€‘
ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’è‡ªå‹•åŒ–
â†’ ä½œæ¥­ãƒªã‚¹ãƒˆè‡ªå‹•ç”Ÿæˆ
â†’ ã‚¢ãƒ©ãƒ¼ãƒˆé€šçŸ¥
â†’ ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ
```

---

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

**ä»Šã™ãã§ãã‚‹ã“ã¨:**

1. æ—¢å­˜MCPã‚µãƒ¼ãƒãƒ¼ã‚’è©¦ã™
   - Filesystem MCP
   - GitHub MCP

2. ç°¡å˜ãªã‚«ã‚¹ã‚¿ãƒ MCPã‚’ä½œã‚‹
   - è‡ªåˆ†ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹
   - æ—¢å­˜APIã®çµ±åˆ

3. 07ç« ã®ç‰¹åŒ–å‹æ©Ÿèƒ½ã«MCPã‚’çµ±åˆ
   - è‚²å…ã‚¢ãƒ—ãƒª + åœ°åŸŸæƒ…å ±
   - æ ½åŸ¹ã‚¢ãƒ—ãƒª + æ°—è±¡ãƒ‡ãƒ¼ã‚¿
   - å®¶è¨ˆç°¿ + é‡‘èãƒ‡ãƒ¼ã‚¿

4. è¤‡æ•°MCPã‚’çµ„ã¿åˆã‚ã›ã‚‹
   - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼è‡ªå‹•åŒ–
   - æ„æ€æ±ºå®šæ”¯æ´

---

**æœ¬æ ¼é–‹ç™ºã¸ã®æº–å‚™ãŒæ•´ã£ãŸã‚‰:**

ğŸ“˜ **05ç« ï¼ˆChef's Specialsï¼‰ã¸**
- Cursor + Claude ã§åŠ¹ç‡é–‹ç™º
- Flutter ã§ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ 
- MCP ã‚’çµ„ã¿è¾¼ã‚“ã æœ¬æ ¼ã‚¢ãƒ—ãƒª
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£é§†å‹•é–‹ç™º

---

**MCPã¯ã€ã‚ãªãŸã®BYOAã‚¢ãƒ—ãƒªã‚’å¤–ã®ä¸–ç•Œã¨ç¹‹ãã€**
**å°‚é–€çš„ãªä¾¡å€¤ã‚’ç”Ÿã¿å‡ºã™å¼·åŠ›ãªãƒ„ãƒ¼ãƒ«ã§ã™ã€‚**

**ä¸€æ­©ãšã¤çµ±åˆã‚’é€²ã‚ã¦ã€å”¯ä¸€ç„¡äºŒã®ã‚¢ãƒ—ãƒªã‚’ä½œã‚Šã¾ã—ã‚‡ã†ï¼**
